import{_ as N}from"./DVoZgbCL.js";import{c as r,a,w as l,u as y,j,o,F as d,r as _,b as f,t as v,f as F,d as h,e as R,h as w,g as O}from"./CieyZeqY.js";import{_ as q}from"./CpPZ24ox.js";import{a as A,_ as E}from"./DHyMCrqv.js";import{_ as I}from"./vR6oncno.js";import{_ as L}from"./B2G9jZ8k.js";import{_ as T}from"./CG6VOwGi.js";import b from"./CTeE01yd.js";import{o as W,s as D,t as G,a as H}from"./DVaoNImg.js";import"./B2BGwm_d.js";import"./CQPWnddS.js";import"./Bz3WuopR.js";import"./BsbbbC8T.js";import"./C-Hxb1qw.js";import"./Cc9ga_jp.js";import"./CtNNcClz.js";import"./CQTm2Kze.js";const J={key:0},K={key:1},M={class:"p-4 flex-1"},Q={class:"flex justify-end"},X={class:"grid grid-cols-2 my-2"},Y={data(){return{openSide:!1,resource:{permissions:[]},options:b,allPermissions:[]}},methods:{createResource(){j("/roles",{method:"POST",body:this.resource}).then(()=>{this.openSide=!1,this.$refs.table.refresh(),this.resource={permissions:[]}})},async openSideWithRes(){var u,n,e;this.openSide=!0,await((u=this.$refs.table)==null?void 0:u.response),this.allPermissions=this.groupPermission((e=(n=this.$refs.table)==null?void 0:n.response)==null?void 0:e.permissions)},groupPermission(u){const n={};return u.forEach(e=>{var t;n.hasOwnProperty(e.group)?(t=n[e.group])==null||t.push(e.name):n[e.group]=[e.name]}),console.log(n),n}}},he=Object.assign(Y,{__name:"index",setup(u){const n=W({name:D("Name is required"),permissions:G([H()],"Permissions is required")});return(e,t)=>{const g=N,k=w,x=q,U=O,P=A,V=E,C=I,$=L,z=T;return o(),r("div",null,[a(x,{ref:"table",columns:y(b).columns,filters:y(b).filters,url:"/roles",ui:{th:{base:"text-left"}}},{"roles-data":l(({row:s})=>[(o(!0),r(d,null,_(s.roles,i=>(o(),f(g,{key:i.name,ui:{rounded:"rounded-full"},class:"mx-1 capitalize",size:"xs",label:i.name,color:i.name.toLowerCase().includes("admin")?"emerald":"orange"},null,8,["label","color"]))),128))]),"permissions-data":l(({row:s,response:i})=>{var m,c;return[(m=s.permissions)!=null&&m.length?(o(),r("div",J,[(o(!0),r(d,null,_((c=i.permissions)==null?void 0:c.map(p=>p.name),p=>{var S;return o(),f(g,{key:p,title:p,ui:{rounded:"rounded-full"},color:(S=s.permissions)!=null&&S.map(B=>B.name).includes(p)?"emerald":"gray",class:"mx-1 w-4 h-4"},null,8,["title","color"])}),128))])):(o(),r("span",K,v(s.name)+" has no permissions yet",1))]}),"extra-header":l(()=>[e.$can("create roles")?(o(),f(k,{key:0,size:"xs",onClick:e.openSideWithRes,label:"Add Role"},null,8,["onClick"])):F("",!0)]),_:1},8,["columns","filters"]),a(z,{modelValue:e.openSide,"onUpdate:modelValue":t[2]||(t[2]=s=>e.openSide=s)},{default:l(()=>[h("div",M,[a($,{schema:y(n),state:e.resource,onSubmit:e.createResource},{default:l(()=>[h("div",Q,[a(k,{type:"submit",color:"primary",variant:"outline"},{default:l(()=>[a(U,{name:"heroicons:user-plus"}),R(" Create User ")]),_:1})]),a(V,{class:"my-2 capitalize",label:"Name",name:"name"},{default:l(()=>[a(P,{icon:"i-heroicons-shield-exclamation",size:"md",modelValue:e.resource.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.resource.name=s),variant:"outline"},null,8,["modelValue"])]),_:1}),a(V,{class:"my-2 capitalize",label:"Permissions",name:"permissions"},{default:l(()=>[(o(!0),r(d,null,_(Object.keys(e.allPermissions),(s,i)=>(o(),r("div",{class:"my-4",key:i},[h("h4",null,v(s),1),h("div",X,[(o(!0),r(d,null,_(e.allPermissions[s],m=>(o(),f(C,{value:m,key:m,modelValue:e.resource.permissions,"onUpdate:modelValue":t[1]||(t[1]=c=>e.resource.permissions=c),label:m,name:m},null,8,["value","modelValue","label","name"]))),128))])]))),128))]),_:1})]),_:1},8,["schema","state","onSubmit"])])]),_:1},8,["modelValue"])])}}});export{he as default};
