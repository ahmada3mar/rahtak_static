import{a as U,_ as w}from"./DHyMCrqv.js";import{l as V,o as c,c as h,d as e,t as m,a as s,w as a,e as C,h as N,j as f,a9 as _,m as g,b as y,f as v}from"./CieyZeqY.js";import{_ as P}from"./B2G9jZ8k.js";import{_ as q}from"./C-Hxb1qw.js";import{_ as B}from"./CQTm2Kze.js";const R=""+new URL("logo.zfvLQMK6.png",import.meta.url).href,S={props:{details:{default:{transaction:0,created_at:0,billerName:0,serviceType:0,invoice:0,customerName:0,amount:0,fees:0,addtionalAmount:0,rahtakFees:0,total:0,branch:"طبربور"}}},data(){return{logo:R}},methods:{print(){const d=document.getElementById("print").innerHTML;console.log(d);const l=window.open("","","height=600,width=800");l.document.write('<html dir="rtl" ><head><title>Print</title>'),l.document.write("</head><body>"),l.document.write(d),l.document.write("</body></html>"),l.document.close(),l.print()}}},j={class:"bg-white"},D={id:"print"},E={style:{display:"flex","flex-direction":"column"}},L=["src"],z={style:{padding:"5px 15px"},class:"flex flex-col w-full"},I={style:{width:"100%","line-height":"40px"}},M=e("td",{style:{"text-align":"start"}},"رقم الحركة",-1),O=e("td",{style:{"text-align":"start"}},"اسم المفوتر",-1),G=e("td",{style:{"text-align":"start"}},"نوع الخدمة",-1),H=e("td",{style:{"text-align":"start"}},"رقم الدفع الالكتروني",-1),K=e("td",{style:{"text-align":"start"}},"اسم العميل",-1),Q=e("td",{style:{"text-align":"start"}},"القيمة",-1),W=e("td",{style:{"text-align":"start"}},"العمولة",-1),J=e("td",{style:{"text-align":"start"}},"القيمة المضافة",-1),X=e("td",{style:{"text-align":"start"}},"عمولة راحتك",-1),Y=e("td",{style:{"text-align":"start"}},"اجمالي القيمة",-1),Z=e("tr",null,[e("td",{colspan:"2"},[e("hr")])],-1),$=e("td",{style:{"text-align":"start"}},"التاريخ",-1),ee=e("td",{style:{"text-align":"start"}},"الفرع",-1),te=e("tr",null,[e("td",{colspan:"2"},[e("hr")])],-1),le=e("div",{class:"flex justify-center",style:{"text-align":"center","margin-top":"20px"}},[e("h1",null,"0799991230"),e("h1",null,"info@rahtak.net")],-1);function se(d,l,o,r,t,p){const i=N;return c(),h("div",j,[e("div",D,[e("div",E,[e("img",{style:{height:"100px",margin:"10px auto 50px  auto"},class:"transition-all h-10 ease-in duration-300 my-5 short",src:t.logo},null,8,L),e("div",z,[e("table",I,[e("tr",null,[M,e("td",null,m(o.details.transaction),1)]),e("tr",null,[O,e("td",null,m(o.details.billerName),1)]),e("tr",null,[G,e("td",null,m(o.details.serviceType),1)]),e("tr",null,[H,e("td",null,m(o.details.invoice),1)]),e("tr",null,[K,e("td",null,m(o.details.no),1)]),e("tr",null,[Q,e("td",null,m(parseFloat(o.details.amount)),1)]),e("tr",null,[W,e("td",null,m(parseFloat(o.details.fees)),1)]),e("tr",null,[J,e("td",null,m(parseFloat(o.details.addtionalAmount)),1)]),e("tr",null,[X,e("td",null,m(parseFloat(o.details.rahtakFees)),1)]),e("tr",null,[Y,e("td",null,m(parseFloat(o.details.total)),1)]),Z,e("tr",null,[$,e("td",null,m(o.details.created_at),1)]),e("tr",null,[ee,e("td",null,m(o.details.branch),1)]),te]),le])])]),s(i,{onClick:p.print},{default:a(()=>[C("طباعة")]),_:1},8,["onClick"])])}const ne=V(S,[["render",se]]),ae={data(){return{input:{},cat:[],billingNo:"",catValue:"",response:null,paid:!1,paymentAmount:0,client:null,user:{name:null,mobile:null},payments:{amount:0,fees:0,addtionalAmount:0}}},mounted(){f(`/sadad/get-service-details/${_().params.id}`).then(d=>{this.input=d.input,this.cat=d.cat})},methods:{saveUser(){this.client={...this.user}},removeUser(){this.client=null},getFees(){return this.payments.amount<=100?.25:(parseInt((this.payments.amount-1)/100)+1)*.5-.25},inq(){const[d,l]=_().params.service.split("_");let o={paymentType:this.input.paymentType,catValue:this.catValue,billingNo:this.billingNo,service:d,id:_().params.id,code:l,billingNoRequired:this.input.billingNoRequired,containsPrepaidCats:this.input.containsPrepaidCats,paymentAmount:this.paymentAmount};f("/sadad/inquire",{method:"POST",body:o}).then(r=>{this.response=r,this.payments.addtionalAmount=parseFloat(r.addtionalAmount),this.payments.amount=parseFloat(r.amount),this.payments.fees=parseFloat(r.fees)}).catch(r=>{g().add({title:r.response._data.message,color:"orange"})})},pay(){const[d,l]=_().params.service.split("_");let o={paymentType:this.input.paymentType,catValue:this.catValue,billingNo:this.billingNo,billerName:d,billerCode:l,billerType:_().params.type,totalPayment:this.response.totalPayment,dueAmount:this.response.dueAmount,serviceTypeNo:_().params.id,transType:this.response.transType,amount:this.response.amount,fees:this.response.fees,rahtak_fees:this.getFees(),validationCode:this.response.validationCode,clientName:"ahmad emar",clientMobile:"0799991230",billingNoRequired:this.input.billingNoRequired,containsPrepaidCats:this.input.containsPrepaidCats,additionalAmount:this.payments.addtionalAmount??0};f(`/sadad/pay/${_().params.id}`,{method:"POST",body:o}).then(r=>{g().add({title:"تم الدفع بنجاح",color:"green"}),this.paid={transaction:r.bankTrxID,created_at:r.sTMTDate,billerName:d,serviceType:_().params.type,invoice:this.billingNo,customerName:this.response.customerName,amount:this.payments.amount,fees:this.payments.fees,addtionalAmount:this.payments.addtionalAmount,rahtakFees:this.getFees(),total:parseFloat(this.getFees()+Object.values(this.payments).reduce((t,p)=>t+p,0)),branch:"tabrbor"}}).catch(r=>{g().add({title:r.response._data.message,color:"red"})})}}},oe={class:"py-5 px-2"},ie={key:0},ue=e("h4",{class:"my-5"},"معلومات العميل",-1),de={class:"flex mt-5 justify-between"},re=e("h4",{class:"my-5"},"معلومات الدفعة",-1),me={key:2},pe={class:"flex mt-5 justify-between"};function ce(d,l,o,r,t,p){const i=U,u=w,b=N,x=P,F=q,T=B,k=ne;return c(),h("div",oe,[t.paid?(c(),y(k,{key:1,details:t.paid},null,8,["details"])):(c(),y(T,{key:0},{default:a(()=>[t.client?(c(),y(x,{key:1,onSubmit:l[12]||(l[12]=n=>t.response?p.pay():p.inq())},{default:a(()=>[re,t.cat.length>1?(c(),y(u,{key:0,class:"my-2",label:"الفئة"},{default:a(()=>[s(F,{modelValue:t.catValue,"onUpdate:modelValue":l[4]||(l[4]=n=>t.catValue=n),options:t.cat,"option-attribute":"nameEn","value-attribute":"nameEn"},null,8,["modelValue","options"])]),_:1})):v("",!0),s(u,{class:"my-2",label:t.input.arDesc},{default:a(()=>[s(i,{"onUpdate:modelValue":[l[5]||(l[5]=n=>t.response=null),l[6]||(l[6]=n=>t.billingNo=n)],modelValue:t.billingNo,placeholder:t.input.arDesc},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t.input.billingNoRequired&&!t.input.containsPrepaidCats?(c(),y(u,{key:1,class:"my-2",label:"القيمة"},{default:a(()=>[s(i,{"onUpdate:modelValue":[l[7]||(l[7]=n=>t.response=null),l[8]||(l[8]=n=>t.paymentAmount=n)],modelValue:t.paymentAmount,placeholder:"ادخل القيمة"},null,8,["modelValue"])]),_:1})):v("",!0),t.response?(c(),h("div",me,[s(u,{class:"my-2",label:"اسم العميل"},{default:a(()=>[s(i,{disabled:!0,value:t.response.customerName},null,8,["value"])]),_:1}),s(u,{class:"my-2",label:"ملاحظات"},{default:a(()=>[s(i,{disabled:!0,value:t.response.freeText},null,8,["value"])]),_:1}),s(u,{class:"my-2",label:"الحد الأعلى"},{default:a(()=>[s(i,{disabled:!0,value:t.response.maxPaymentLimit},null,8,["value"])]),_:1}),s(u,{class:"my-2",label:"الحد الأدنى"},{default:a(()=>[s(i,{disabled:!0,value:t.response.minPaymentLimit},null,8,["value"])]),_:1}),s(u,{class:"my-2",label:"القيمة"},{default:a(()=>[s(i,{type:"number",disabled:!t.response.isAmountEnabled,modelValue:t.payments.amount,"onUpdate:modelValue":l[9]||(l[9]=n=>t.payments.amount=n)},null,8,["disabled","modelValue"])]),_:1}),s(u,{class:"my-2",label:"عمولات"},{default:a(()=>[s(i,{disabled:!0,modelValue:t.payments.fees,"onUpdate:modelValue":l[10]||(l[10]=n=>t.payments.fees=n)},null,8,["modelValue"])]),_:1}),s(u,{class:"my-2",label:"القيمة المضافة"},{default:a(()=>[s(i,{disabled:!0,modelValue:t.payments.addtionalAmount,"onUpdate:modelValue":l[11]||(l[11]=n=>t.payments.addtionalAmount=n)},null,8,["modelValue"])]),_:1}),s(u,{class:"my-2",label:"عمولة راحتك"},{default:a(()=>[s(i,{disabled:!0,type:"number",value:p.getFees()},null,8,["value"])]),_:1}),s(u,{class:"my-2",label:"القيمة الكلية"},{default:a(()=>[s(i,{disabled:!0,value:parseFloat(p.getFees()+Object.values(t.payments).reduce((n,A)=>n+A,0))},null,8,["value"])]),_:1})])):v("",!0),e("div",pe,[s(b,{onClick:p.removeUser,size:"lg",color:"gray",class:"",label:"رجوع"},null,8,["onClick"]),s(b,{size:"lg",type:"submit",class:"mr-auto",label:t.response?"دفع":"استعلام"},null,8,["label"])])]),_:1})):(c(),h("div",ie,[s(x,{onSubmit:p.saveUser},{default:a(()=>[ue,s(u,{class:"my-2",label:"رقم هاتف العميل"},{default:a(()=>[s(i,{"onUpdate:modelValue":[l[0]||(l[0]=n=>t.response=null),l[1]||(l[1]=n=>t.user.mobile=n)],modelValue:t.user.mobile,placeholder:"رقم الهاتف"},null,8,["modelValue"])]),_:1}),s(u,{class:"my-2",label:"اسم العميل"},{default:a(()=>[s(i,{"onUpdate:modelValue":[l[2]||(l[2]=n=>t.response=null),l[3]||(l[3]=n=>t.user.name=n)],modelValue:t.user.name,placeholder:"الأسم"},null,8,["modelValue"])]),_:1}),e("div",de,[s(b,{size:"lg",type:"submit",class:"mr-auto",label:"التالي"})])]),_:1},8,["onSubmit"])]))]),_:1}))])}const ge=V(ae,[["render",ce]]);export{ge as default};
